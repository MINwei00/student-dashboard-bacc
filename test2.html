<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMUnify Integrated Portal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    
    <style>
        /* Custom colors based on user request */
        :root {
            --color-dark-blue: #141C52;
            --color-gold: #8A704C; 
            --color-white: #FFFFFF;
            --color-light-background: #f0f4f8; 
            --color-card-bg: #FFFFFF;
            --color-schedule-bg: #e5e7eb;
            --color-tile-bg: #f8f8f8;
            --color-progress-track: #e0e0e0; 

            /* Custom Tile Colors */
            --color-tile-icon-1: #a339b0; /* BOSS Bidding - Pink/Purple */
            --color-tile-icon-2: #32b265; /* eLearn - Green */
            --color-tile-icon-3: #169a9d; /* OnTRAC II - Teal */
            --color-tile-icon-4: #24619d; /* GPA Calc - Blue */
            --color-tile-icon-5: #f05a2e; /* Schedule - Orange/Red */
        }

        .bg-dark-blue { background-color: var(--color-dark-blue); }
        .text-dark-blue { color: var(--color-dark-blue); }
        .bg-gold { background-color: var(--color-gold); }
        .text-gold { color: var(--color-gold); }
        .bg-schedule { background-color: var(--color-schedule-bg); }
        .bg-tile { background-color: var(--color-tile-bg); }
        .bg-light-bg { background-color: var(--color-light-background); }

        /* Custom progress bar styles */
        .progress-bar-container {
            height: 8px;
            background-color: var(--color-progress-track);
            border-radius: 4px;
            overflow: hidden;
        }
        .progress-bar {
            height: 100%;
            background-color: var(--color-gold);
            border-radius: 4px;
        }

        /* Styling the dashboard tab button colors */
        .tab-active {
            background-color: var(--color-gold);
            color: white;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .tab-inactive {
            background-color: white;
            color: #6b7280; 
        }

        /* Schedule Card Styling (for the left column) */
        .schedule-card {
            background-color: var(--color-card-bg);
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            padding: 1rem;
        }
        
        /* Chatbot Style */
        df-messenger {
            z-index: 999;
            position: fixed;
            display: block;
            --df-messenger-font-color: #000;
            --df-messenger-font-family: Google Sans;
            --df-messenger-chat-background: #8A704C; 
            --df-messenger-message-user-background: #d3e3fd; 
            --df-messenger-message-bot-background: #FFFFFF; 
            bottom: 16px;
            right: 16px;
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'dark-blue': '#141C52',
                        'portal-gold': '#8A704C',
                        'light-bg': '#f0f4f8',
                        'tile-bg': '#f8f8f8',
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    
    <link rel="stylesheet" href="https://www.gstatic.com/dialogflow-console/fast/df-messenger/prod/v1/themes/df-messenger-default.css">
    <script src="https://www.gstatic.com/dialogflow-console/fast/df-messenger/prod/v1/df-messenger.js"></script>
</head>
<body class="bg-light-bg font-sans min-h-screen">

    <nav class="bg-dark-blue text-white text-xs py-1 px-4 shadow-md flex justify-between items-center">
        <div class="font-bold tracking-wider">BACHELOR OF ACCOUNTANCY (BACC)</div>
        <div class="flex space-x-4">
            <a href="#" class="hover:text-portal-gold transition duration-200">GLOSSARY</a>
            <a href="#" class="hover:text-portal-gold transition duration-200"><i class="fas fa-question-circle mr-1"></i>FAQ</a>
            <a href="#" class="hover:text-portal-gold transition duration-200"><i class="far fa-calendar-alt mr-1"></i>CALENDAR</a>
            <a href="#" class="hover:text-portal-gold transition duration-200"><i class="fas fa-print mr-1"></i>PRINT</a>
        </div>
    </nav>

    <header class="bg-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-2 flex justify-between items-center">
        <div class="flex items-center">
            <div class="text-2xl font-extrabold text-dark-blue leading-none">SMU</div>
            <div class="text-2xl font-bold text-portal-gold leading-none">nify</div>
        </div>
            
            <div class="flex space-x-1 lg:space-x-4">
                <a href="#" class="flex items-center p-2 rounded-full bg-portal-gold text-white font-semibold text-sm transition duration-200 shadow-md">
                    <i class="fas fa-briefcase mr-1.5"></i> BOSS
                </a>
                <a href="#" class="flex items-center p-2 rounded-full text-dark-blue hover:bg-light-bg font-semibold text-sm transition duration-200">
                    <i class="fas fa-graduation-cap mr-1.5"></i> ACADEMIC
                </a>
                <a href="#" class="flex items-center p-2 rounded-full text-dark-blue hover:bg-light-bg font-semibold text-sm transition duration-200">
                    <i class="fas fa-dollar-sign mr-1.5"></i> FINANCE & ADMIN
                </a>
                <a href="#" class="flex items-center p-2 rounded-full text-dark-blue hover:bg-light-bg font-semibold text-sm transition duration-200">
                    <i class="fas fa-heartbeat mr-1.5"></i> CAMPUS LIFE & EXCHANGE
                </a>
                <a href="#" class="flex items-center p-2 rounded-full text-dark-blue hover:bg-light-bg font-semibold text-sm transition duration-200">
                    <i class="fas fa-wrench mr-1.5"></i> CAREERS & COMM SERVICE
                </a>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            
            <div class="lg:col-span-1 space-y-6">
                <div class="schedule-card p-4">
                    <h2 class="text-lg font-bold text-dark-blue mb-4 flex items-center">
                        <i class="far fa-calendar-alt mr-2 text-dark-blue"></i> MY CLASS & EXAM SCHEDULE
                    </h2>

                    <div class="flex flex-col space-y-2 mb-4">
                        <div class="text-sm font-semibold text-gray-700">SHOW</div>
                        <select class="p-2 border border-gray-300 rounded-lg text-sm focus:ring-portal-gold focus:border-portal-gold transition duration-150">
                            <option>Class Schedules</option>
                            <option>Exam Schedules</option>
                        </select>
                    </div>
                    
                    <div class="flex items-center justify-between bg-schedule rounded-lg p-2 mb-4 text-sm font-medium border border-gray-300">
                        <button class="text-dark-blue hover:text-portal-gold font-bold p-1 rounded-md transition duration-150">Prev</button>
                        <span class="text-dark-blue">17 - 21 Nov 2025</span>
                        <button class="text-dark-blue hover:text-portal-gold font-bold p-1 rounded-md transition duration-150">Next</button>
                    </div>

                    <div class="space-y-3 max-h-[60vh] overflow-y-auto pr-2">
                        <div class="bg-schedule p-3 rounded-lg shadow-md border-l-4 border-portal-gold">
                            <div class="text-xs font-semibold text-dark-blue uppercase mb-1">CLASS</div>
                            <div class="flex">
                                <div class="w-1/4 text-center">
                                    <div class="text-xl font-bold text-dark-blue">MON</div>
                                    <div class="text-sm text-dark-blue">17 NOV</div>
                                </div>
                                <div class="w-3/4 pl-4 border-l border-gray-400">
                                    <p class="font-bold text-base text-dark-blue">1:45PM - 3:15PM</p>
                                    <p class="text-portal-gold font-semibold">FNCE101 Finance</p>
                                    <p class="text-xs text-gray-600">SOA Seminar Room 3-3</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-schedule p-3 rounded-lg shadow-md border-l-4 border-dark-blue/20">
                            <div class="text-xs font-semibold text-dark-blue uppercase mb-1">CLASS</div>
                            <div class="flex">
                                <div class="w-1/4 text-center">
                                    <div class="text-xl font-bold text-dark-blue">WED</div>
                                    <div class="text-sm text-dark-blue">19 NOV</div>
                                </div>
                                <div class="w-3/4 pl-4 border-l border-gray-400">
                                    <p class="font-bold text-base text-dark-blue">8:15AM - 11:30AM</p>
                                    <p class="text-portal-gold font-semibold">ACCT224 Financial Reporting and Analysis</p>
                                    <p class="text-xs text-gray-600">SOA Seminar Room 2-3</p>
                                </div>
                            </div>
                        </div>

                        <div class="bg-schedule p-3 rounded-lg shadow-md border-l-4 border-dark-blue/20">
                            <div class="text-xs font-semibold text-dark-blue uppercase mb-1">CLASS</div>
                            <div class="flex">
                                <div class="w-1/4 text-center">
                                    <div class="text-xl font-bold text-dark-blue">WED</div>
                                    <div class="text-sm text-dark-blue">19 NOV</div>
                                </div>
                                <div class="w-3/4 pl-4 border-l border-gray-400">
                                    <p class="font-bold text-base text-dark-blue">1:45PM - 3:15PM</p>
                                    <p class="text-portal-gold font-semibold">COR2408 Spanish</p>
                                    <p class="text-xs text-gray-600">YPHSL Seminar Room 2-04</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-schedule p-3 rounded-lg shadow-md border-l-4 border-dark-blue/20">
                            <div class="text-xs font-semibold text-dark-blue uppercase mb-1">CLASS</div>
                            <div class="flex">
                                <div class="w-1/4 text-center">
                                    <div class="text-xl font-bold text-dark-blue">FRI</div>
                                    <div class="text-sm text-dark-blue">21 NOV</div>
                                </div>
                                <div class="w-3/4 pl-4 border-l border-gray-400">
                                    <p class="font-bold text-base text-dark-blue">3:30PM - 6:45PM</p>
                                    <p class="text-portal-gold font-semibold">ACCT223 Taxation</p>
                                    <p class="text-xs text-gray-600">SOA Seminar Room 5-3</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="lg:col-span-2 space-y-6">
                <div class="p-4 bg-white rounded-xl shadow-xl border border-gray-100 h-full">
                    
                    <div class="flex items-center space-x-3 mb-6">
                        <i class="fas fa-th-large text-xl text-gray-700"></i>
                        <h1 class="text-xl font-bold text-dark-blue">DASHBOARD</h1>
                    </div>

                    <div class="flex space-x-0 border-b border-gray-300 mb-6 -mt-3">
                        <button class="py-3 px-8 text-sm font-semibold border-t border-l border-r border-gray-300 rounded-t-lg tab-active -mb-px">
                            LEARN
                        </button>
                        <button class="py-3 px-8 text-sm font-semibold tab-inactive hover:text-dark-blue transition duration-150">
                            LIVE
                        </button>
                        <button class="py-3 px-8 text-sm font-semibold tab-inactive hover:text-dark-blue transition duration-150">
                            LINK
                        </button>
                    </div>
                    
                    <div class="relative mb-6">
                        <input type="search" placeholder="Search..." class="w-full p-3 pl-10 border border-gray-300 rounded-xl focus:ring-portal-gold focus:border-portal-gold transition duration-150 bg-light-bg">
                        <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"></i>
                    </div>
                    <div class="flex justify-start mb-6">
                        <button id="reset-chat-button" class="flex items-center text-sm font-semibold text-portal-gold hover:text-dark-blue transition duration-150 p-2 rounded-lg border border-portal-gold hover:border-dark-blue bg-white shadow-sm">
                            <i class="fas fa-redo-alt mr-2"></i> Reset Chat Conversation
                        </button>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        
                        <div class="space-y-6">
                            <div class="p-4 bg-white rounded-xl shadow-md border border-gray-100">
                                <h2 class="text-lg font-bold text-dark-blue mb-4">Course Management</h2>
                                
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center text-sm">
                                        <span class="font-medium text-gray-700">Current GPA:</span>
                                        <span class="font-bold text-dark-blue">3.85</span>
                                    </div>
                                    
                                    <div>
                                        <div class="flex justify-between items-center text-sm mb-1">
                                            <span class="text-gray-700">Enrolled Courses</span>
                                            <span class="font-semibold text-dark-blue">4</span>
                                        </div>
                                        <div class="progress-bar-container">
                                            <div class="progress-bar" style="width: 70%;"></div>
                                        </div>
                                    </div>

                                    <div>
                                        <div class="flex justify-between items-center text-sm mb-1">
                                            <span class="text-gray-700">Credits Earned:</span>
                                            <span class="font-semibold text-dark-blue">24</span>
                                        </div>
                                        <div class="progress-bar-container">
                                            <div class="progress-bar" style="width: 60%;"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <a href="#" class="block p-4 bg-tile rounded-xl shadow-md hover:shadow-lg transition duration-200 border-l-4 border-tile-icon-1">
                                <div class="flex items-center">
                                    <i class="fas fa-hammer text-xl mr-4 text-tile-icon-1"></i>
                                    <span class="font-medium text-dark-blue">BOSS Bidding</span>
                                </div>
                            </a>

                            <a href="#" class="block p-4 bg-tile rounded-xl shadow-md hover:shadow-lg transition duration-200 border-l-4 border-tile-icon-2">
                                <div class="flex items-center">
                                    <i class="fas fa-book-open text-xl mr-4 text-tile-icon-2"></i>
                                    <span class="font-medium text-dark-blue">eLearn</span>
                                </div>
                            </a>
                            
                            <a href="#" class="block p-4 bg-tile rounded-xl shadow-md hover:shadow-lg transition duration-200 border-l-4 border-green-500">
                                <div class="flex items-center">
                                    <i class="fas fa-clipboard-check text-xl mr-4 text-green-500"></i>
                                    <span class="font-medium text-dark-blue">Grading & Participation</span>
                                </div>
                            </a>
                            
                        </div>

                        <div class="space-y-6">
                            <div class="p-4 bg-white rounded-xl shadow-md border border-gray-100">
                                <h2 class="text-lg font-bold text-dark-blue mb-4">Assignment & Assessments</h2>
                                
                                <div class="space-y-3">
                                    <div>
                                        <div class="flex justify-between items-center text-sm mb-1">
                                            <span class="text-gray-700">Pending</span>
                                            <span class="font-semibold text-dark-blue">3</span>
                                        </div>
                                        <div class="progress-bar-container">
                                            <div class="progress-bar" style="width: 30%;"></div>
                                        </div>
                                    </div>

                                    <div>
                                        <div class="flex justify-between items-center text-sm mb-1">
                                            <span class="text-gray-700">Submitted</span>
                                            <span class="font-semibold text-dark-blue">6</span>
                                        </div>
                                        <div class="progress-bar-container">
                                            <div class="progress-bar" style="width: 75%;"></div>
                                        </div>
                                    </div>

                                    <div class="flex justify-between items-center text-sm">
                                        <span class="font-medium text-gray-700">On Time Rate</span>
                                        <span class="font-bold text-dark-blue">94%</span>
                                    </div>
                                </div>
                            </div>

                            <a href="#" class="block p-4 bg-tile rounded-xl shadow-md hover:shadow-lg transition duration-200 border-l-4 border-tile-icon-3">
                                <div class="flex items-center">
                                    <i class="fas fa-map-marker-alt text-xl mr-4 text-tile-icon-3"></i>
                                    <span class="font-medium text-dark-blue">OnTRAC II</span>
                                </div>
                            </a>

                            <a href="#" class="block p-4 bg-tile rounded-xl shadow-md hover:shadow-lg transition duration-200 border-l-4 border-tile-icon-4">
                                <div class="flex items-center">
                                    <i class="fas fa-calculator text-xl mr-4 text-tile-icon-4"></i>
                                    <span class="font-medium text-dark-blue">Curriculum Worksheet & GPA Calculator</span>
                                </div>
                            </a>
                            
                            <a href="#" class="block p-4 bg-tile rounded-xl shadow-md hover:shadow-lg transition duration-200 border-l-4 border-tile-icon-5">
                                <div class="flex items-center">
                                    <i class="far fa-calendar-alt text-xl mr-4 text-tile-icon-5"></i>
                                    <span class="font-medium text-dark-blue">Class & Exam Schedule</span>
                                </div>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            
        </div>
    </main>

    <df-messenger
        location="us-central1"
        project-id="chabot-project-474504"
        agent-id="d2d35358-19c4-407d-819d-85d820fde224"
        language-code="en"
        max-query-length="-1">
        <df-messenger-chat-bubble
            chat-title="SMU-UNIFY">
        </df-messenger-chat-bubble>
    </df-messenger>
    
<script>
    document.addEventListener('DOMContentLoaded', () => {
        // Select the single, stable df-messenger element
        const dfMessenger = document.querySelector('df-messenger');
        const resetButton = document.getElementById('reset-chat-button');
        
        // Define the custom reset event name that is configured in Dialogflow CX
        const RESET_EVENT = 'CUSTOM_RESET'; 
        
        // Retrieve the language code attribute from the df-messenger element
        const languageCode = dfMessenger ? dfMessenger.getAttribute('language-code') || 'en' : 'en';

        if (dfMessenger && resetButton) {
            resetButton.addEventListener('click', () => {
                
                // 1. Forceful Visual Clear
                try {
                    const chatPane = dfMessenger.shadowRoot.querySelector('df-chat-pane');
                    if (chatPane) {
                        const historyContainer = chatPane.shadowRoot.querySelector('.chat-history-container');
                        if (historyContainer) {
                            historyContainer.innerHTML = '';
                            console.log('Visual history forcefully cleared from Shadow DOM.');
                        }
                    }
                } catch (e) {
                    console.error('Shadow DOM access failed for visual clear. Falling back to session reset.', e);
                }

                // 2. Context Clear (Clears the session on the Dialogflow backend)
                dfMessenger.dispatchEvent(new Event('df-clear-session'));
                
                // 3. Initiate New Conversation by silently sending the CUSTOM_RESET event
                // The delay (500ms) ensures the backend session has finished clearing before the new event arrives.
                setTimeout(() => {
                    // *** CRITICAL TWEAK: Using the derived languageCode variable in the payload ***
                    dfMessenger.renderCustomText({
                        event: {
                            name: RESET_EVENT,
                            languageCode: languageCode // Use the retrieved variable
                        }
                    }); 
                    console.log(`New session started by silently triggering ${RESET_EVENT} event with language ${languageCode}.`);
                }, 500);

                console.log('Chatbot reset sequence executed.');
            });
        }
    });
</script>
</body>
</html>